task addVersionsToScripts

addVersionsToScripts {
	def scriptBat = file('scripts/db_upgrade.bat')
	def scriptBatWithVersion = new File(temporaryDir, 'db_upgrade.bat')
	def scriptSh = file('scripts/db_upgrade.sh')
	def scriptShWithVersion = new File(temporaryDir, 'db_upgrade.sh')

	outputs.file scriptBatWithVersion
	outputs.file scriptShWithVersion

	doLast {
		def contents = scriptBat.getText( 'UTF-8' )

		scriptBatWithVersion.write(contents.replaceAll("com.liferay.portal.tools.db.upgrade.client.jar", jar.archiveName), 'UTF-8')

		contents = scriptSh.getText( 'UTF-8' )

		scriptShWithVersion.write(contents.replaceAll("com.liferay.portal.tools.db.upgrade.client.jar", jar.archiveName), 'UTF-8')
	}
}

dependencies {
	compileInclude group: "com.liferay", name: "com.liferay.gogo.shell.client", version: "1.0.0"
	compileInclude group: "commons-cli", name: "commons-cli", version: "1.3.1"
	compileInclude group: "jline", name: "jline", version: "2.12"
}

deploy {
	from ("properties") {
		include "*.properties"
	}
	from ("scripts") {
		include "*.bat"
		include "*.sh"
	}
}

distributions {
	main {
		contents {
			from("properties") {
				include "*.properties"
				into "lib"
			}
			from (addVersionsToScripts) {
				into "lib"
			}
		}
	}
}

liferayOSGi {
	expandCompileInclude = true
}